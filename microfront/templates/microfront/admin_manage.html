<html>
<head>
    <title>website manage system</title>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <link href="../skin/css/base.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="../skin/css/menu.css" type="text/css" />

    <script type="text/javascript" src="../skin/tiny_mce/tiny_mce.js"></script>
    <script language="javascript" type="text/javascript" src="../skin/frame/addr.js"></script>
    <script type="text/javascript">
        tinyMCE.init({
            // mode : "textareas",
            mode : "specific_textareas",
            editor_selector : "myTextEditor",
            theme : "advanced",
            plugins : "pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template,wordcount,advlist,autosave",
         
            // Theme options
            theme_advanced_buttons1 : "save,newdocument,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,styleselect,formatselect,fontselect,fontsizeselect,fullscreen,code",
            theme_advanced_buttons2 : "cut,copy,paste,pastetext,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,anchor,image,cleanup,|,insertdate,inserttime,preview,|,forecolor,backcolor",
            theme_advanced_buttons3 : "tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|,charmap,emotions,iespell,media,advhr,|,print,|,ltr,rtl",
         
            theme_advanced_toolbar_location : "top",
            theme_advanced_toolbar_align : "left",
            theme_advanced_statusbar_location : "bottom",
            theme_advanced_resizing : true,
         
            // Example content CSS (should be your site CSS)
            //content_css : "/css/style.css",
         
            template_external_list_url : "lists/template_list.js",
            external_link_list_url : "lists/link_list.js",
            external_image_list_url : "lists/image_list.js",
            media_external_list_url : "lists/media_list.js",
         
            // Style formats
            style_formats : [
                {title : 'Bold text', inline : 'strong'},
                {title : 'Red text', inline : 'span', styles : {color : '#ff0000'}},
                {title : 'Help', inline : 'strong', classes : 'help'},
                {title : 'Table styles'},
                {title : 'Table row 1', selector : 'tr', classes : 'tablerow'}
            ],
         
            width: '700',
            height: '400'
        });
    </script>

    <script language='javascript'>
        function saveProvince() {
            // var myaddr = "广东省深圳市" + $("#area").val()
            var myaddr = $("#dlscity").val() + $("#dlsarea").val() + $("#area").val()
            var id = '';
            $.post("../addr/", {"area": myaddr}, function(data){id=data;alert("保存成功");
                $("#addr-header").after('<tr id="dladdr_'+id+'" align="center" bgcolor="#FAFAF1" height="22"><td width=\"90%\"><input id="dlarea_'+id+'" type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:530px;" value="' + myaddr + '" /></td><td width=\"10%\"><a href="#" onclick="saveAddr('+id+')">编辑</a>|<a href="#" onclick="delAddr('+id+')">删除</a></td></tr>');
            });
        }
        
        function saveAddr(id) {
            $.post("../dladdr/save/", {"dladdr_id":id, "area":$("#dlarea_"+id).val()}, function(data){alert("保存成功");});
        }
        
        function delAddr(id) {
            $.post("../dladdr/del/", {"dladdr_id":id}, function(data){alert("删除成功");});
            $("#dladdr_"+id).remove();
        }

        function dlTimeAdd() {
            var mytime = $("#dlbegin").val()
            mytime += "-----"
            mytime += $("#dlend").val()
            $.post("../dltime/add/", {"begin_time":$("#dlbegin").val(), "end_time": $("#dlend").val()}, function(data){
                var id = data;
                alert("保存成功");
                $("#dltime-header").after('<tr id="dltime_'+id+'" align="left" bgcolor="#FAFAF1" height="22"><td width=\"90%\"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:530px;" id="dltimeinfo_'+id+'" value="' + mytime + '" /></td><td width=\"10%\"><a href="#" onclick="dlTimeUpd('+id+')">编辑</a>|<a href="#" onclick="dlTimeDel(' + id + ')">删除</a></td></tr>');
            });
        }

        function dlTimeUpd(id) {
            $.post("../dltime/save/", {"dltime_id":id, "dltime_info":$("#dltimeinfo_"+id).val()}, function(data){alert("保存成功");});
        }

        function dlTimeDel(id) {
            $.post("../dltime/del/", {"dltime_id":id}, function(data){alert("删除成功");});
            $("#dltime_"+id).remove();
        }

        function saveOtherSet() {
            $.post("../otherset/save/", {"dx_mobile":$("#dx_mobile").val(), "kf_phone":$("#kf_phone").val(), "tip_content":$("#tip_content").val(), "distribution_range":$("#distribution_range").val(), "freight":$("#freight").val()}, function(data){alert("保存成功");});
        }

        function orderUpd(id) {
            //$("orderedit_"+id).text()="保存";
            $.post("../orders/save/", {"order_id":id, "order_status":$("#orderstatus_"+id).val(), "order_info":$("#orderinfo_"+id).val(), "order_addr":$("#orderaddr_"+id).val()}, function(data){alert("保存成功");});
        }

        function orderDel(id) {
            $.post("../orders/del/", {"order_id":id}, function(data){alert("删除成功");});
            $("#ordertr_"+id).remove();
        }

        function cataDel(id) {
            $.post("../catalog/del/", {"catalog_id":id}, function(data){alert("删除成功");});
            $("#catatr_"+id).remove();
        }

        function cataSave(id) {
            // $("#catasts_"+id).attr("checked", true);
            if ($("#catasts_"+id).is(":checked")) {
                status = 1;
            } else {
                status = 0;
            }
            $.post("../catalog/save/", {"catalog_id":id, "catalog_name":$("#cataname_"+id).val(), "catalog_sts":status, "catalog_sort":$("#catasort_"+id).val()}, function(data){alert("保存成功");});
        }

        function userUpd(id) {
            $.post("../users/save/", {"id":id, "name":$("#usrname_"+id).val(), "phone":$("#usrphone_"+id).val(), "money":$("#usrmny_"+id).val()}, function(data){alert("保存成功");});
        }

        function userDel(id) {
            $.post("../users/del/", {"id":id}, function(data){alert("删除成功");});
            $("#usertr_"+id).remove();
        }

        function queryUser() {
            $(".usertr").remove()
            $.post("../users/query/", {"keyword":$("#usrsrch").val()}, function(data){
                var jo = eval('('+data+')');
                // alert("post data: "+typeof(jo));
                $.each(jo.user, function(key, value){
                    // alert(value.openid);
                     // $("#users-header").after('<tr class="usertr" id="usertr_'+value.id+'" align="center" bgcolor="#FAFAF1" height="22"><td width="10%">'+value.openid+'</td><td width="12%"><input type="text" id="usrname_'+value.id+'" value="'+value.name+'" /></td>');  // after
                    $("#users-header").after('<tr class="usertr" id="usertr_'+value.id+'" align="center" bgcolor="#FAFAF1" height="22"><td width="10%">'+value.openid+'</td><td width="12%"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:130px;" id="usrname_'+value.id+'" value="'+value.name+'" /></td><td width="12%"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:130px;" id="usrphone_'+value.id+'" value="'+value.phone+'" /></td><td width="8%"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:130px;" id="usrmny_'+value.id+'" value="'+value.money+'" /></td><td width="16%"><a href="#" onclick="userUpd('+value.id+')">保存</a>|<a href="#" onclick="userDel('+value.id+')">删除</a></td></tr>');  // after
                }); // $.each()
            }); // $.post()
        }

        var preFrameW = '206,*';
        var FrameHide = 0;
        var curStyle = 1;
        var totalItem = 9;
        function ChangeMenu(way){
            var addwidth = 10;
            var fcol = top.document.all.btFrame.cols;
            if(way==1) addwidth = 10;
            else if(way==-1) addwidth = -10;
            else if(way==0){
                if(FrameHide == 0){
                    preFrameW = top.document.all.btFrame.cols;
                    top.document.all.btFrame.cols = '0,*';
                    FrameHide = 1;
                    return;
                }else{
                    top.document.all.btFrame.cols = preFrameW;
                    FrameHide = 0;
                    return;
                }
            }
            fcols = fcol.split(',');
            fcols[0] = parseInt(fcols[0]) + addwidth;
            top.document.all.btFrame.cols = fcols[0]+',*';
        }

        function mv(selobj,moveout,itemnum)
        {
           if(itemnum==curStyle) return false;
           if(moveout=='m') selobj.className = 'itemsel';
           if(moveout=='o') selobj.className = 'item';
           return true;
        }

        function changeSel(itemnum)
        {
          curStyle = itemnum;
          for(i=1;i<=totalItem;i++)
          {
             if(document.getElementById('item'+i)) document.getElementById('item'+i).className='item';
          }
          document.getElementById('item'+itemnum).className='itemsel';
        }

        function orderQuery()
        {
            $('#order').show();
            $('#catalist').hide();
            $('#foodlist').hide();
            $('#foodupd').hide();
            $('#cataupd').hide();
            $('#dladdrupd').hide();
            $('#dltimeupd').hide();
            $('#usershow').hide();
            $('#configshow').hide();
            $('#ingredt').hide();
        }

        function foodShow()
        {
            $('#foodlist').show();
            $('#foodupd').hide();
            $('#order').hide();
            $('#catalist').hide();
            $('#cataupd').hide();
            $('#dladdrupd').hide();
            $('#dltimeupd').hide();
            $('#usershow').hide();
            $('#configshow').hide();
            $('#ingredt').hide();
        }

        function foodUpd(id)
        {
            if (typeof(id) != 'undefined' && id != '0'){
                // $("#updfoodname").val() = $("#foodname_"+id).val();
                $("#updfoodname").val($("#foodname_"+id).text());
                $("#updfoodamount").val($("#foodtotal_"+id).text());
                $("#updfoodoprice").val($("#foodoprice_"+id).text());
                $("#updfoodprice").val($("#foodprice_"+id).text());
                $("#updfoodstatus").val($("#foodstatus_"+id).val());
                $("#updfoodgenre").val($("#foodgenre_"+id).val());
                $("#updfoodid").val(id);
            } 
            if (id == '0'){
                // alert(id)
                $("#updfoodname").val("");
                $("#updfoodamount").val("");
                $("#updfoodoprice").val("");
                $("#updfoodprice").val("");
                $("#updfoodstatus").val("on");
            }
            $('#foodupd').show();
            $('#foodlist').hide();
            $('#order').hide();
            $('#catalist').hide();
            $('#cataupd').hide();
            $('#dladdrupd').hide();
            $('#dltimeupd').hide();
            $('#usershow').hide();
            $('#configshow').hide();
            $('#ingredt').hide();
        }

        function foodDel(id) {
            $.post("../foods/del/", {"food_id":id}, function(data){alert("删除成功");});
            $("#foodtr_"+id).remove();
        }

        function foodSrch() {
            $.post("../foods/srch/", {"name":$("#fsrch_kw").val(), "sstaus":$("#fsrch_staus").val(), "sgenre":$("#fsrch_genre").val(), "scatalog":$("#fsrch_cata").val()}, function(data){
                if ("food_srch"==data) {
                    $(".foodtr").remove();
                    alert("未找到符合条件的结果");
                } else {
                    jsond = eval('(' + data + ')'); 
                    $(".foodtr").remove();
                    for (ii in jsond) {
                        fields = jsond[ii]['fields'];
                        food_id = jsond[ii]['pk'];
                        // $("#foodtr_header").after('<tr id="' + fields['id'] + '" class="foodtr" align="center" bgcolor="#FAFAF1" height="22"><td>' + fields['id'] + '</td><td><img style="width:20px; height:20px;" src="/micromall/'+ fields['cover_url'] + '"></td><td id="foodname_' + fields['id'] + '">' + fields['name'] + '</td><td id="foodcata_' + fields['id'] + '" class="foodcatalog">' + fields['catalog_id'] + '</td><td id="foodoprice_' + fields['id'] + '">' + fields['old_price'] + '</td><td id="foodprice_' + fields['id'] + '">' + fields['price'] + '</td><td id="foodtotal_' + fields['id'] + '">' + fields['total'] + '</td><td>' + fields['sales'] + '</td><td id="foodstatus_' + fields['id'] + '" class="foodstatus">' + fields['status'] + '</td><td id="foodgenre_' + fields['id'] + '" class="foodgenre">' + fields['genre'] + '</td><td class="foodlevel">' + fields['level'] + '</td><td><a href="#" onclick="foodUpd(' + fields['id'] + ')">编辑</a>|<a href="#" onclick="foodDel(' + fields['id'] + ')">删除</a></td></tr>')
                        $("#foodtr_header").after('<tr id="' + food_id + '" class="foodtr" align="center" bgcolor="#FAFAF1" height="22"><td>' + food_id + '</td><td><img style="width:20px; height:20px;" src="/micromall/'+ fields['cover_url'] + '"></td><td id="foodname_' + food_id + '">' + fields['name'] + '</td><td id="foodcata_' + food_id + '" class="foodcatalog">' + fields['catalog_id'] + '</td><td id="foodoprice_' + food_id + '">' + fields['old_price'] + '</td><td id="foodprice_' + food_id + '">' + fields['price'] + '</td><td id="foodtotal_' + food_id + '">' + fields['total'] + '</td><td>' + fields['sales'] + '</td><td id="foodstatus_' + food_id + '" class="foodstatus">' + fields['status'] + '</td><td id="foodgenre_' + food_id + '" class="foodgenre">' + fields['genre'] + '</td><td class="foodlevel">' + fields['level'] + '</td><td><a href="#" onclick="foodUpd(' + food_id + ')">编辑</a>|<a href="#" onclick="foodDel(' + food_id + ')">删除</a></td></tr>');
                    }
                }

                var g_cata={{ g_catajson|safe }}
                $('.foodcatalog').each(function(){
                    cid = $(this).text();
                    // alert("category:"+g_cata[cid]);
                    $(this).text(g_cata[cid]);
                });

                var g_foodstatus={"2":"下架", "1":"上架", "0":"上架"};
                $('.foodstatus').each(function(){
                    cid = $(this).text();
                    // alert("status:"+g_foodstatus[cid]);
                    $(this).text(g_foodstatus[cid]);
                });

                /*
                $(function(){
                    var categories = $('.foodstatus')
                    var len = categories.length
                    for(var i = 0; i < len; i++){
                        var category=categories[i];
                        if(category.innerHTML=='2'){
                            category.innerHTML='下架'
                        }
                        if(category.innerHTML=='1'){
                            category.innerHTML='上架'
                        }
                        if(category.innerHTML=='0'){
                            category.innerHTML='上架'
                        }
                    }
                })*/

                $(function(){
                    var categories = $('.foodgenre')
                    var len = categories.length
                    for(var i = 0; i < len; i++){
                        var category=categories[i];
                        if(category.innerHTML=='1'){
                            category.innerHTML='普通'
                        }
                        if(category.innerHTML=='2'){
                            category.innerHTML='特价'
                        }
                        if(category.innerHTML=='3'){
                            category.innerHTML='推荐'
                        }
                        if (category.innerHTML=='0'){
                            category.innerHTML='普通'
                        }
                    }
                }) // function foodgenre

            }); // post

            // alert("Search food...");

        } // foodSrch()

        function cataShow()
        {
            $('#catalist').show();
            $('#foodlist').hide();
            $('#foodupd').hide();
            $('#order').hide();
            $('#cataupd').hide();
            $('#dladdrupd').hide();
            $('#dltimeupd').hide();
            $('#usershow').hide();
            $('#configshow').hide();
            $('#ingredt').hide();
        }

        function cataUpd(id)
        {
            $('#cataupd').show();
            $('#foodupd').hide();
            $('#foodlist').hide();
            $('#order').hide();
            $('#catalist').hide();
            $('#dladdrupd').hide();
            $('#dltimeupd').hide();
            $('#usershow').hide();
            $('#configshow').hide();
            $('#ingredt').hide();
        }

        function dladdrUpd()
        {
            $('#dladdrupd').show();
            $('#foodupd').hide();
            $('#foodlist').hide();
            $('#order').hide();
            $('#catalist').hide();
            $('#cataupd').hide();
            $('#dltimeupd').hide();
            $('#usershow').hide();
            $('#configshow').hide();
            $('#ingredt').hide();
        }

        function dltimeUpd()
        {
            $('#dltimeupd').show();
            $('#dladdrupd').hide();
            $('#foodupd').hide();
            $('#foodlist').hide();
            $('#order').hide();
            $('#catalist').hide();
            $('#cataupd').hide();
            $('#usershow').hide();
            $('#configshow').hide();
            $('#ingredt').hide();
        }

        function userShow()
        {
            $('#usershow').show();
            $('#dltimeupd').hide();
            $('#dladdrupd').hide();
            $('#foodupd').hide();
            $('#foodlist').hide();
            $('#order').hide();
            $('#catalist').hide();
            $('#cataupd').hide();
            $('#configshow').hide();
            $('#ingredt').hide();
        }

        function configShow()
        {
            $('#configshow').show();
            $('#usershow').hide();
            $('#dltimeupd').hide();
            $('#dladdrupd').hide();
            $('#foodupd').hide();
            $('#foodlist').hide();
            $('#order').hide();
            $('#catalist').hide();
            $('#cataupd').hide();
            $('#ingredt').hide();
        }

        function ingredtShow()
        {
            $('#ingredt').show();
            $("#zhuliao").addClass("active");
            $("#fuliao").removeClass("active");
            $('#configshow').hide();
            $('#usershow').hide();
            $('#dltimeupd').hide();
            $('#dladdrupd').hide();
            $('#foodupd').hide();
            $('#foodlist').hide();
            $('#order').hide();
            $('#catalist').hide();
            $('#cataupd').hide();
        }
    </script>
    <script language='javascript'>var curopenItem = '1';</script>
    <script language="javascript" type="text/javascript" src="../skin/js/frame/menu.js"></script>
    <style>
{ padding:0px; margin:0px; }
#tpa {
    color: #009933;
    margin:0px;
    padding:0px;
    float:right;
    padding-right:10px;
}

#tpa dd {
    margin:0px;
    padding:0px;
    float:left;
    margin-right:2px;
}

#tpa dd.ditem {
    margin-right:8px;
}

#tpa dd.img {
  padding-top:6px;
}

div.item
{
  text-align:center;
    background:url(../skin/images/frame/topitembg.gif) 0px 3px no-repeat;
    width:82px;
    height:26px;
    line-height:28px;
}

.itemsel {
  width:80px;
  text-align:center;
  background:#226411;
    border-left:1px solid #c5f097;
    border-right:1px solid #c5f097;
    border-top:1px solid #c5f097;
    height:26px;
    line-height:28px;
}

*html .itemsel {
    height:26px;
    line-height:26px;
}

a:link,a:visited {
 text-decoration: underline;
}

.item a:link, .item a:visited {
    font-size: 12px;
    color: #ffffff;
    text-decoration: none;
    font-weight: bold;
}

.itemsel a:hover {
    color: #ffffff;
    font-weight: bold;
    border-bottom:2px solid #E9FC65;
}

.itemsel a:link, .itemsel a:visited {
    font-size: 12px;
    color: #ffffff;
    text-decoration: none;
    font-weight: bold;
}

.itemsel a:hover {
    color: #ffffff;
    border-bottom:2px solid #E9FC65;
}

.container-fluid {
  padding-right: 20px;
  padding-left: 20px;
  *zoom: 1;
}
.container-fluid:before,
.container-fluid:after {
  display: table;
  content: "";
  line-height: 0;
}
.container-fluid:after {
  clear: both;
}

.nav {
  margin-left: 0;
  margin-bottom: 20px;
  list-style: none;
}
.nav > li > a {
  display: block;
}

.nav > li > a {
  display: block;
}

.nav > li > a:hover {
  text-decoration: none;
  background-color: #FAFAF1;
}

.nav-tabs,
.nav-pills {
  *zoom: 1;
}
.nav-tabs:before,
.nav-pills:before,
.nav-tabs:after,
.nav-pills:after {
  display: table;
  content: "";
  line-height: 0;
}
.nav-tabs:after,
.nav-pills:after {
  clear: both;
}
.nav-tabs > li,
.nav-pills > li {
  float: left;
}
.nav-tabs > li > a,
.nav-pills > li > a {
  padding-right: 12px;
  padding-left: 12px;
  margin-right: 2px;
  line-height: 14px;
}
.nav-tabs {
  border-bottom: 1px solid #ddd;
}
.nav-tabs > li {
  margin-bottom: -1px;
}
.nav-tabs > li > a {
  padding-top: 8px;
  padding-bottom: 8px;
  line-height: 20px;
  border: 1px solid transparent;
  -webkit-border-radius: 4px 4px 0 0;
  -moz-border-radius: 4px 4px 0 0;
  border-radius: 4px 4px 0 0;
}
.nav-tabs > li > a:hover {
  border-color: #eeeeee #eeeeee #dddddd;
}
.nav-tabs > .active > a,
.nav-tabs > .active > a:hover {
  color: #555555;
  background-color: #ffffff;
  border: 1px solid #ddd;
  border-bottom-color: transparent;
  cursor: default;
}

.rmain {
  padding-left:10px;
  /* background:url(../skin/images/frame/toprightbg.gif) no-repeat; */
}
    body{
          margin:0;
          scrollbar-base-color:#C0D586;
          scrollbar-arrow-color:#FFFFFF;
          scrollbar-shadow-color:DEEFC6;
        }
        #navigator{
            width:100%;
            height:30px;
            background-color:#545652;
        }
        a{
            color:white;
            text-decoration:none;
        }
        #all{
            margin:0 auto;
            width:960;
        }
        #add-food{
            margin-left:150px;
            margin-top:50px;
            //margin:0 auto;
        }
        .active-item{
            background-color:#83bf73;
        }
        #food-list{
            margin:0 auto;
            //background-color:#ccc;
            margin-top:20px;
            width:960px;
        }
        #add-catalog{
            margin-left:150px;
            margin-top:50px;
            //margin:0 auto;
        }
        .food{
            height:220px;
        }
        img{
            width:100%;
            height:100%;
        }
        .food-img{
            width:200px;
            height:200px;
            float:left;
        }
        .food-detail table{
            padding-left:20;
            padding-top:20px;
        }
        input[type='text']{
            width:400px;
        }
        input[type='submit']{
             display: inline-block;
              vertical-align: top;
              position: relative;
              overflow: hidden;
              //line-height: 80px;
              padding: 0 0px;
              font-size: 20px;
              color: white;
              text-align: center;
              text-decoration: none;
              text-shadow: 0 1px #154c86;
              background-color: #3a6ea5;
              background-clip: padding-box;
              border: 1px solid;
              border-color: #1c65b2 #18589c #18589c;
              border-radius: 4px;
              -webkit-box-shadow: inset 0 1px rgba(255, 255, 255, 0.4), 0 1px 2px rgba(0, 0, 0, 0.2);
              box-shadow: inset 0 1px rgba(255, 255, 255, 0.4), 0 1px 2px rgba(0, 0, 0, 0.2);
              background-image: -webkit-linear-gradient(top, rgba(255, 255, 255, 0.3), rgba(255, 255, 255, 0) 50%, rgba(0, 0, 0, 0.12) 51%, rgba(0, 0, 0, 0.04));
              background-image: -moz-linear-gradient(top, rgba(255, 255, 255, 0.3), rgba(255, 255, 255, 0) 50%, rgba(0, 0, 0, 0.12) 51%, rgba(0, 0, 0, 0.04));
              background-image: -o-linear-gradient(top, rgba(255, 255, 255, 0.3), rgba(255, 255, 255, 0) 50%, rgba(0, 0, 0, 0.12) 51%, rgba(0, 0, 0, 0.04));
              background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.3), rgba(255, 255, 255, 0) 50%, rgba(0, 0, 0, 0.12) 51%, rgba(0, 0, 0, 0.04));
              font-family: 微软雅黑;
              width:100px;
              margin-left:350;
        }
        input[type='submit']:hover {
          background-color: #1a74d3;
        }
        textarea{
            width:400px;
        }
    </style>
</head>
<body>
<script src='../js/components/jquery/jquery.min.js'></script>
<script>
$(function(){
    $('#order').show();
    $('#foodlist').hide();
    $('#foodupd').hide();
    $('#catalist').hide();
    $('#cataupd').hide();
    $('#dladdrupd').hide();
    $('#dltimeupd').hide();
    $('#usershow').hide();
    $('#configshow').hide();

    $('#update-food').hide();
    $('#ingredt').hide();
    $('#food-list').show();
    $('#admin-manage').show();
    
    $('.nav-item').click(function(){
        $('.nav-item').removeClass('active-item')
        $(this).addClass('active-item')
        if($(this).text()=='添加新商品'){
            $('#update-food').show();
            $('#food-list').hide();
            $('#admin-manage').hide();
        }else if($(this).text()=='已有商品'){
            $('#update-food').hide();
            $('#admin-manage').hide();
            $('#food-list').show();
        }else if($(this).text().substr(0,3)=='管理员'){
            $('#update-food').hide();
            $('#admin-manage').show();
            $('#food-list').hide();
        }
    })
    
    $('#form1').submit(function(){
        var foodid=$("#updfoodid").val();
        var foodname=$('input[name="foodname"]').val()
        var foodprice=$('input[name="foodprice"]').val()
        var foodimage=$('input[type="file"]').val();
        // alert(typeof(foodid));
        if ('0' == foodid) {
            if(foodname==''){
                alert('请输入商品名称');
                return false;
            }
            if(foodprice==''){
                alert('请输入商品价格');
                return false;
                if(isNaN(foodprice)){
                    alert('请输入有效商品价格');
                    return false;
                }
            }
            if(foodimage==''){
                alert('请上传商品图片')
                return false;
            }
        }
    })
})
</script>
<!-- disable origin html
explain  -->
<table width="100%" border="0" cellpadding="0" cellspacing="0" background="../skin/images/frame/topbg.gif">
  <tbody><tr>
    <td width="20%" height="60"><img src="../skin/images/frame/logo.gif"></td>
    <td width="80%" align="right" valign="bottom">
        <table width="750" border="0" cellspacing="0" cellpadding="0">
      <tbody><tr>
      <td align="right" height="26" style="padding-right:10px;line-height:26px;">
            您好：<span class="username"><b>{{admin_name}}</b></span>，欢迎使用后台管理系统！            
            [<a href="" target="_blank">修改密码</a>]
            [<a href="exit" target="_top">注销退出</a>]&nbsp;
      </td>
      </tr>
      </tbody></table></td>
  </tr>
</tbody>
</table>

<!-- left -->
<div id='left' style="width: 20%;float:left">
<table width='99%' height="100%" border='0' cellspacing='0' cellpadding='0'>
  <tr>
    <td style='padding-left:3px;padding-top:8px' valign="top">
        <!-- Item 1 Strat -->
      <dl class='bitem'>
        <dt onClick='showHide("items1_1")'><b>订单管理</b></dt>
        <dd style='display:block' class='sitem' id='items1_1'>
          <ul class='sitemu'>
            <li>
              <div class='items'>
                <div class='fllct' onClick='orderQuery()'><a href='javascript:void(0)' target='main'>当前订单</a></div>                
              </div>
            </li>
          </ul>
        </dd>
      </dl>
      <!-- Item 1 End -->
      <!-- Item 2 Strat -->
      <dl class='bitem'>
        <dt onClick='showHide("items2_1")'><b>商品管理</b></dt>
        <dd style='display:block' class='sitem' id='items2_1'>
          <ul class='sitemu'>
            <li>
              <div class='items'>
                <div class='fllct' onClick='foodShow()'><a href='javascript:void(0)' target='main'>查看商品</a></div>
              </div>
            </li>
            <li>
              <div class='items'>
                <div class='fllct' onClick='foodUpd(0)'><a href='javascript:void(0)' target='main'>添加商品</a></div>
              </div>
            </li>
            <li>
              <div class='items'>
                <div class='fllct' onClick='cataShow()'><a href='javascript:void(0)' target='main'>查看分类</a></div>
              </div>
            </li>
            <li>
              <div class='items'>
                <div class='fllct' onClick='cataUpd(0)'><a href='javascript:void(0)' target='main'>添加分类</a></div>
              </div>
            </li>

          </ul>
        </dd>
      </dl>
      <!-- Item 2 End -->

      <!-- Item 2 Strat -->
      <!--dl class='bitem'>
        <dt onClick='showHide("items2_1")'><b>商品分类</b></dt>
        <dd style='display:block' class='sitem' id='items2_1'>
          <ul class='sitemu'>
            <li>
              <div class='items'>
                <div class='fllct' onClick='cataShow()'><a href='javascript:void(0)' target='main'>查看分类</a></div>
              </div>
            </li>
            <li>
              <div class='items'>
                <div class='fllct' onClick='cataUpd()'><a href='javascript:void(0)' target='main'>添加分类</a></div>
              </div>
            </li>
          </ul>
        </dd>
      </dl-->
      <!-- Item 2 End -->

      <!-- Item 3 Strat -->
      <dl class='bitem'>
          <dt onClick='showHide("items3_1")'><b>会员管理</b></dt>
          <dd style='display:block' class='sitem' id='items3_1'>
          <ul class='sitemu'>
            <li><div class='items'><div class='fllct' onClick='userShow()'><a href='javascript:void(0)' target='main'>会员管理</a></div></div></li>            
            <li><a href='javascript:void(0)' target='_blank'>特权管理</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>会员等级</a></li>            
          </ul>
        </dd>
      </dl>    
      <!-- Item 3 End -->

      <!-- Item 5 Strat -->
      <dl class='bitem'>
          <dt onClick='showHide("items5_1")'><b>管理面板</b></dt>
          <dd style='display:block' class='sitem' id='items5_1'>
          <ul class='sitemu'>
            <li>
              <div class='items'>
                <div class='fllct' onClick='dladdrUpd()'><a href='javascript:void(0)' target='main'>配送地址管理</a></div>
              </div>
            </li>
            <li><div class='items'><div class='fllct' onClick='dltimeUpd()'><a href='javascript:void(0)' target='_blank'>配送时间管理</a></div></div></li>            
            <li><a href='javascript:void(0)' target='_blank'>首页文字管理</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>首页目录管理</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>会员充值赠送设置</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>营业时间设置</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>支付方式设置</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>系统公告</a></li>            
            <li><div class='items'><div class='fllct' onClick='configShow();return false;'><a href='javascript:void(0)' target='_blank'>其他设置</a></div></div></li>            
          </ul>
        </dd>
      </dl>    
      <!-- Item 5 End -->
 
      <!-- Item 6 Strat -->
      <dl class='bitem'>
          <dt onClick='showHide("items6_1")'><b>公众号管理</b></dt>
          <dd style='display:block' class='sitem' id='items6_1'>
          <ul class='sitemu'>
            <li><a href='javascript:void(0)' target='_blank'>素材管理</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>关键词管理</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>关注回复</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>菜单回复</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>客户留言</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>公众账号绑定管理</a></li>            
          </ul>
        </dd>
      </dl>    
     <!-- Item 6 End -->
 
      <!-- Item 7 Strat -->
      <dl class='bitem'>
          <dt onClick='showHide("items7_1")'><b>统计信息</b></dt>
          <dd style='display:block' class='sitem' id='items7_1'>
          <ul class='sitemu'>
            <li><a href='javascript:void(0)' target='_blank'>总订单统计</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>微网站点击量</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>支付宝订单统计</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>团购订单统计</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>会员充值记录</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>结算单</a></li>            
          </ul>
        </dd>
      </dl>    
     <!-- Item 7 End -->
  
      <!-- Item 8 Strat -->
      <dl class='bitem'>
          <dt onClick='showHide("items8_1")'><b>报表管理</b></dt>
          <dd style='display:block' class='sitem' id='items8_1'>
          <ul class='sitemu'>
            <li><a href='javascript:void(0)' target='_blank'>业绩报表</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>产品销售报表</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>会员管理报表</a></li>            
          </ul>
        </dd>
      </dl>    
     <!-- Item 8 End -->
 
      <!-- Item 9 Strat -->
      <dl class='bitem'>
          <dt onClick='showHide("items9_1")'><b>微调研</b></dt>
          <dd style='display:block' class='sitem' id='items8_1'>
          <ul class='sitemu'>
            <li><a href='javascript:void(0)' target='_blank'>调研管理</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>微投票</a></li>            
          </ul>
        </dd>
      </dl>    
     <!-- Item 9 End -->

      <!-- Item 10 Strat -->
      <dl class='bitem'>
          <dt onClick='showHide("items10_1")'><b>系统设置</b></dt>
          <dd style='display:block' class='sitem' id='items10_1'>
          <ul class='sitemu'>
            <li><a href='javascript:void(0)' target='_blank'>网站信息设置</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>数据库连接配置</a></li>            
          </ul>
        </dd>
      </dl>    
    <!-- Item 10 End -->
 
      <!-- Item 11 Strat -->
      <dl class='bitem'>
          <dt onClick='showHide("items11_1")'><b>后台管理</b></dt>
          <dd style='display:block' class='sitem' id='items11_1'>
          <ul class='sitemu'>
            <li><a href='javascript:void(0)' target='_blank'>用户管理</a></li>            
            <li><a href='javascript:void(0)' target='_blank'>角色管理</a></li>            
          </ul>
        </dd>
      </dl>    
     <!-- Item 11 End -->

      </td>
  </tr>
</table>
</div>
<!-- left -->

<!-- center -->
<!-- 内容列表 -->
<div id='order' style="width: 80%;float:left;margin-left: -2em;">

  <table width="100%">
  <tbody>
  <tr>
    <td width="80%">
      <form action="/microfront/orders/date" method="get" id="searchForm">
        <input type="text" name="cdate" class="text-info" placeholder="输入选择日期(格式:年-月-日)"" onfocus="WdatePicker(_start)">
        <input type="submit" style="vertical-align:baseline;margin-left:5;font-family:微软雅黑;font-size:15px;" value="查询">
        <input type="submit" style="vertical-align:baseline;margin-left:5;font-family:微软雅黑;font-size:15px;" value="采购清单">
        <input type="submit" style="vertical-align:baseline;margin-left:5;font-family:微软雅黑;font-size:15px;" value="商品清单">
        <h4>当前查询日营业额：<font color="red">{{turnover.price__sum}}</font>(元),总营业额:<font color="red">{{total_turnover.price__sum}}</font>(元)</h4>
      </form>
    </td>
    <td width="20%" align="right">
        <a href="/microfront/orders/export?orgid=109&cdate=2014-04-07" target="_blank" style="vertical-align:baseline;margin-left:5;font-family:微软雅黑;font-size:15px;">订单导出到Excel</a>
        <!--input type="submit" style="vertical-align:baseline;margin-left:5;font-family:微软雅黑;font-size:12px;width=200px;" value="订单导出到Excel"-->
    </td>
   </tr>
   </tbody>
   </table>


<form name="form2">
<table width="100%" border="0" cellpadding="2" cellspacing="1" bgcolor="#D1DDAA" align="center" style="margin-top:8px">
<tr align="center" bgcolor="#FAFAF1" height="22">
    <td width="1%">订单号</td>
    <td width="8%">注册会员卡号</td>
    <td width="10%">收货人/手机</td>
    <td width="13%">用户住址</td>
    <td width="4%">总价</td>
    <td width="2%">商品数量</td>
    <td width="8%">下单时间</td>
    <td width="10%">配送时间</td>
    <td width="5%">备注信息</td>
    <td width="6%">支付方式</td>
    <td width="17%">所购产品</td>
    <td width="6%">订单状态</td>
    <td width="5%">操作</td>
</tr>
<!-- order item list -->
{%for order in orders%}
    <tr id="ordertr_{{order.id}}" align="center" bgcolor="#FAFAF1" height="22">
    <td width="1%">{{order.id}}</td>
    <td width="8%">{{order.openid}}</td>
    <td width="10%" class="orderinfo"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:130px;" id="orderinfo_{{order.id}}" value="{{order.name}}/{{order.phone}}" /></td>
    <td width="13%" class="orderaddr"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-s
tyle:none;width:130px;" id="orderaddr_{{order.id}}" value="{{order.address}}" /></td>
    <td width="4%">{{order.price}}</td>
    <td width="2%">{{order.amount}}</td>
    <td width="6%">{{order.order_time|date:'Y-m-d H:i'}}</td>
    <td width="10%" class="deliverytime">{{order.delivery_time}}</td>
    <td width="5%">{{order.remark}}</td>
    <td width="6%" class="paytype">{{order.pay_type}}</td>
    <td width="19%">{{order.shoplist}}</td>
    <td width="6%" class="dlstatus"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:130px;" id="orderstatus_{{order.id}}" value="{{order.order_status}}" /></td>
    <td width="5%"><a href="#" id="orderedit_{{order.id}}" onclick="orderUpd({{order.id}})">编辑</a>|<a href="#" onclick="orderDel({{order.id}})">删除</a></td>
    </tr>
{%endfor%}
<script>
        $(function(){
            var categories = $('.paytype')
            var len = categories.length
            for(var i = 0; i < len; i++){
                var category=categories[i];
                if(category.innerHTML=='1'){
                    category.innerHTML='支付宝方式'
                }
                if(category.innerHTML=='0'){
                    category.innerHTML='货到付款'
                }
                if(category.innerHTML=='2'){
                    category.innerHTML='货到付款'
                }
                if(category.innerHTML=='yinpin'){
                    category.innerHTML='饮品'
                }
            }
        })
        $(function(){
            var categories = $('.deliverytime')
            var len = categories.length
            for(var i = 0; i < len; i++){
                var category=categories[i];
                if(category.innerHTML=='4'){
                    category.innerHTML='11:00:00-14:30:00'
                }
                if(category.innerHTML=='65'){
                    category.innerHTML='15:30:00-18:00:00'
                }
                if(category.innerHTML=='5'){
                    category.innerHTML='19:30:00-21:00:00'
                }
            }
        })
         $(function(){
            var categories = $('.dlstatus')
            var len = categories.length
            for(var i = 0; i < len; i++){
                var category=categories[i];
                if(category.innerHTML=='0'){
                    category.innerHTML='已下单，未支付，未配送'
                }
                if(category.innerHTML=='1'){
                    category.innerHTML='已下单，未支付，已配送'
                }
                if(category.innerHTML=='2'){
                    category.innerHTML='已下单，已支付，未配送'
                }
                if(category.innerHTML=='3'){
                    category.innerHTML='已下单，已支付，已配送'
                }
            }
        })
 
    </script>
</table>
</form>
</div>

<!-- start: foodlist -->
<div id="foodlist" style="width: 80%;float:left;margin-left: -2em;">
   <table width="98%" border="0" cellpadding="2" cellspacing="1" bgcolor="#D1DDAA" align="center" style="margin-top:8px">
        <tr>
          <td width="50%">
             <input type="text" id="fsrch_kw" class="text-info" placeholder="输入关键字搜索" />
           <select class="span2" id="fsrch_staus">
                 <option value="" selected="selected">全部</option>
                <option value="1">已上架</option>
              <option value="2">未上架</option>
           </select>
           <select class="span2" id="fsrch_genre">
                 <option value="" selected="selected">全部</option>
                <option value="1">普通</option>
              <option value="2">特价</option>
              <option value="3">推荐</option>
            </select>
           <select style="width:80px;" id="fsrch_cata">
              <option value="" selected="selected">全部</option>
              {%for catalog in catalogs %}
                  <option value="{{catalog.id}}">{{ catalog.name }}</option>
              {%endfor%}
           </select>
             <input type="submit" style="vertical-align:baseline;margin-left:5;font-family:微软雅黑;font-size:15px;" value="查询" onclick='foodSrch()';'>
          </td>
        </tr>                            
    </table> 

    <table width="98%" border="0" cellpadding="2" cellspacing="1" bgcolor="#D1DDAA" align="center" style="margin-top:8px">
        <tr id="foodtr_header" align="center" bgcolor="#FAFAF1" height="22">
          <td width="3%">id</td>
          <td width="6%">图片</td>
          <td width="12%">商品名称</td>
          <td width="6%">商品类别</td>
          <td width="8%">原价(元)</td>
          <td width="9%">优惠价(元)</td>
          <td width="6%">数量</td>
          <td width="6%">售出数量</td>
          <td width="6%">上/下架</td>
          <td width="6%">特价/推荐/普通</td>
          <td width="8%">优先级</td>
          <td width="8%">操作</td>
        </tr>
        {%for food in foods%}
        <tr id="foodtr_{{food.id}}" class="foodtr" align="center" bgcolor="#FAFAF1" height="22">
           <td>{{food.id}}</td>
           <td><img style="width:20px; height:20px;" src='/micromall/{{food.cover_url}}'></td>
           <td id="foodname_{{food.id}}"><a href="#" onclick="getIngredts({{food.id}}, 1)">{{food.name}}</a></td>
           <td id="foodcata_{{food.id}}" class="foodcatalog">{{food.catalog_id}}</td>
           <td id="foodoprice_{{food.id}}">{{food.old_price}}</td>
           <td id="foodprice_{{food.id}}">{{food.price}}</td>
           <td id="foodtotal_{{food.id}}">{{food.total}}</td>
           <td>{{food.sales}}</td>
           <td id="foodstatus_{{food.id}}" class="foodstatus">{{food.status}}</td>
           <td id="foodgenre_{{food.id}}" class="foodgenre">{{food.genre}}</td>
           <td class="foodlevel">{{food.level}}</td>
           <td><a href="#" onclick='foodUpd({{food.id}})'>编辑</a>|<a href="#" onclick='foodDel({{food.id}})'>删除</a></td>
        </tr>
        {%endfor%}
        <script>
            // var g_cata={"3":"肉", "6":"素食", "7":"靓汤"};
            var g_cata={{ g_catajson|safe }}
            $('.foodcatalog').each(function(){
                cid = $(this).text();
                // alert("category:"+cid);
                $(this).text(g_cata[cid]);
            });

            $(function(){
                var categories = $('.foodstatus')
                var len = categories.length
                for(var i = 0; i < len; i++){
                    var category=categories[i];
                    if(category.innerHTML=='1'){
                        category.innerHTML='上架'
                    }
                    if(category.innerHTML=='2'){
                        category.innerHTML='下架'
                    }
                    if(category.innerHTML=='0'){
                        category.innerHTML='上架'
                    }
                }
            })

            $(function(){
                var categories = $('.foodgenre')
                var len = categories.length
                for(var i = 0; i < len; i++){
                    var category=categories[i];
                    if(category.innerHTML=='1'){
                        category.innerHTML='普通'
                    }
                    if(category.innerHTML=='2'){
                        category.innerHTML='特价'
                    }
                    if(category.innerHTML=='3'){
                        category.innerHTML='推荐'
                    }
                    if(category.innerHTML=='0'){
                        category.innerHTML='普通'
                    }
                }
            })
        </script>
  </table>
</div>
<!-- end: foodlist -->

<!-- begin: foodupdate -->
<div id='foodupd'  style="width: 80%;float:left;margin-left: -2em;">
    <form id='form1' method='post' enctype="multipart/form-data" accept-charset="UTF-8">
        {% csrf_token %}
        <table id='add-food'>
        <tr><input id="updfoodid" name='foodid' type='hidden' value='0' /></tr>
        <tr>
            <td>目录名</td>
            <td>
                <select name='category'>
                    {%for catalog in catalogs %}
                        <option value="{{catalog.id}}">{{ catalog.name }}</option>
                    {%endfor%}
                </select>
            </td>
        </tr>
        <tr>
            <td>商品名称</td>
            <td><input id='updfoodname' name='foodname' type='text' /></td>
        </tr>
        <tr>
            <td>商品数量</td>
            <td><input id="updfoodamount" name='amount' type='text'/></td>
        </tr>
        <tr>
            <td>商品原价</td>
            <td><input id="updfoodoprice" type='text' name='origprice'/></td>
        </tr>
        <tr>
            <td>商品特价</td>
            <td><input id="updfoodprice" type='text' name='sprice'/></td>
        </tr>
        <tr>
            <td>是否上架</td>
            <td>
                <select id="updfoodstatus" name='food_status'>
                <option value='1'>上架</option>
                <option value='2'>下架</option>
            </td>
        </tr>
        <tr>
            <td>特价/推荐/普通</td>
            <td>
                <select id="updfood_genre" name='food_genre'>
				<option value="1">普通</option>
				<option value="3">推荐</option>
				<option value="2">特价</option>
            </td>
        </tr>
        <tr>
            <td>商品图片</td>
            <td><input type='file' value='upload' name='pic'/></td>
        </tr>
        <tr>
            <td>详情图片</td>
            <td><input type='file' value='upload' name='detail_pic'/></td>
        </tr>
        <tr>
            <td>商品描述</td>
            <td><textarea class="myTextEditor" rows=10 name='introduce'></textarea></td>
        </tr>
        <tr>
        </tr>
        </table>
            <input style="font-size:15px;width:50px;margin-left:50;" type='submit' value='提交'/>
            <input style="font-size:15px;width:150px;margin-left:50;" type='submit' value='保存,进入材料添加页' onclick="ingredtShow(0);return false;";/>
    </form>
</div>
<!-- end: foodupdate -->

<!-- start: catalist -->
<div id="catalist" style="width: 80%;float:left;margin-left: -2em;">
    <table width="98%" border="0" cellpadding="2" cellspacing="1" bgcolor="#D1DDAA" align="center" style="margin-top:8px">
        <tr align="center" bgcolor="#FAFAF1" height="22">
          <td width="60%">名称</td>
          <td width="10%">排序</td>
          <td width="12%">是否启用</td>
          <td width="10%">操作</td>
        </tr>
        {%for catalog in catalogs%}
        <tr align="center" bgcolor="#FAFAF1" height="22" id="catatr_{{catalog.id}}">
            <td><input id="cataname_{{catalog.id}}" value="{{catalog.name}}" /></td>
            <td><input id="catasort_{{catalog.id}}" value="{{catalog.sort}}" /></td>
            <td>
               <input id="catasts_{{catalog.id}}" class="catastatus" type="checkbox" value="{{catalog.status}}">
            </td>
           <td><a href="#" onclick='cataSave({{catalog.id}});'>编辑</a>|<a href="#" onclick='cataDel({{catalog.id}})'>删除</a></td>
        </tr>
        <script>
           $('.catastatus').each(function(){
              sts = parseInt($(this).val());
              if (0 == sts) {
                  $(this).attr("checked", false);
              }

              if (1 == sts) {
                  $(this).attr("checked", true);
              }
            });
        </script>
        {%endfor%}
  </table>
</div>
<!-- end: catalist -->

<!-- begin: cataupdate -->
<div id='cataupd'  style="width: 80%;float:left;margin-left: -2em;">
    <form id='form1' method='post' enctype="multipart/form-data">
        <table id='add-catalog'>
        <tr align="center" bgcolor="#FAFAF1" height="22">
            <td>名称</td>
            <td><input id='updcataname' name='cataname' type='text'/></td>
        </tr>
        <tr align="center" bgcolor="#FAFAF1">
            <td>排序</td>
            <td><input type='text' id='updcatasort' name='cata_sort' size="1"/></td>
        </tr>
        <tr align="left" bgcolor="#FAFAF1">
            <td>是否启用</td>
            <td><input type='checkbox' id='updcatastatus' name='cata_status'/></td>
        </tr>
        </table>
        <input type='submit' value='提交'/>
    </form>
</div>
<!-- end: cataupdate -->

<!-- start: dladdrupd-->
<div id="dladdrupd" style="width: 80%;float:left;margin-left: -2em;">
    选择配送地址
    <select id="dlscity" name="dlscity">
        <option value="深圳市">深圳市</option>
    </select>
    <!--select id="city" name="city"><option value="0">--请先选择省/直辖市--</option><option value="440100">广州市</option><option value="440200">韶关市</option><option value="440300">深圳市</option><option value="440400">珠海市</option><option value="440500">汕头市</option><option value="440600">佛山市</option><option value="440700">江门市</option><option value="440800">湛江市</option><option value="440900">茂名市</option><option value="441200">肇庆市</option><option value="441300">惠州市</option><option value="441400">梅州市</option><option value="441500">汕尾市</option><option value="441600">河源市</option><option value="441700">阳江市</option><option value="441800">清远市</option><option value="441900">东莞市</option><option value="442000">中山市</option><option value="445100">潮州市</option><option value="445200">揭阳市</option><option value="445300">云浮市</option></select-->
    <select id="dlsarea" name="dlsarea"><option value="罗湖区">罗湖区</option><option value="福田区">福田区</option><option value="宝安区">宝安区</option><option value="南山区">南山区</option></select>
    <input type="text" class="span3" name="area" id="area" placeholder="请输入详细位置">
    <input type="button" style="margin-top:-8px;" class="btn btn-info" value="保存" onclick="saveProvince();">;
    <br />
    <br />
    <table id='add-addr' width="98%" border="0" cellpadding="2" cellspacing="1" bgcolor="#D1DDAA" align="center" style="margin-top:8px">
        <tr id='addr-header' align="center" bgcolor="#FAFAF1" height="22">
          <td width="90%">地址</td>
          <td width="10%">操作</td>
        </tr>
        {%for dladdr in dladdrs%}
        <tr id="dladdr_{{dladdr.id}}" align="center" bgcolor="#FAFAF1" height="22">
          <td width="90%"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:530px;" id="dlarea_{{dladdr.id}}" value="{{dladdr.area}}" /></td>
          <td width="10%"><a href="#" onclick="saveAddr({{dladdr.id}})">编辑</a>|<a href="#" onclick="delAddr({{dladdr.id}})">删除</a></td>
        </tr>
        {%endfor%}
    </table>
</div>
<!-- end: dladdrupd -->

<!-- start: dltimeupd-->
<div id="dltimeupd" style="width: 80%;float:left;margin-left: -2em;">
    <input type="text" class="span3" name="begin_dltime" id="dlbegin" placeholder="请输入开始时间">
    <input type="text" class="span3" name="end_dltime" id="dlend" placeholder="请输入结束时间">
    <input type="button" style="margin-top:-8px;" class="btn btn-info" value="保存" onclick="dlTimeAdd();">;
    <br />
    <br />
    <table id='add-dltime' width="98%" border="0" cellpadding="2" cellspacing="1" bgcolor="#D1DDAA" align="center" style="margin-top:8px">
        <tr id='dltime-header' align="center" bgcolor="#FAFAF1" height="22">
          <td width="90%">配送时间</td>
          <td width="10%">操作</td>
        </tr>
        {%for dltime in dltimes%}
        <tr id="dltime_{{dltime.id}}" align="left" bgcolor="#FAFAF1" height="22">
          <td width="90%"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:530px;" id="dltimeinfo_{{dltime.id}}" value="{{dltime.begin_time}}-----{{dltime.end_time}}" /></td>
          <td width="10%"><a href="#" onclick="dlTimeUpd({{dltime.id}})">编辑</a>|<a href="#" onclick="dlTimeDel({{dltime.id}})">删除</a></td>
        </tr>
        {%endfor%}
    </table>
</div>
<!-- end: dltimeupd -->

<!-- start: userShow-->
<div id="usershow"  style="width: 80%;float:left;margin-left: -2em;">
  <table width="98%" border="0" cellpadding="2" cellspacing="1" bgcolor="#D1DDAA" align="center" style="margin-top:8px">
    <tbody>
      <tr>
        <td width="80%">
          <!--form action="/microfront/users/query" method="post"-->
            <input type="text" name="usrsrch"  class="text-info" id="usrsrch" placeholder="输入关键词搜索">
            <input type="button" style="margin-top:-8px;" class="btn btn-info" value="查询" onclick="queryUser();">;
          <!--/form-->
        </td>
       </tr>
     </tbody>
   </table>

    <table id='usertb' width="98%" border="0" cellpadding="2" cellspacing="1" bgcolor="#D1DDAA" align="center" style="margin-top:8px">
        <tr id='users-header' align="center" bgcolor="#FAFAF1" height="12">
          <td width="12%">姓名</td>
          <td width="12%">会员卡号</td>
          <td width="5%">性别</td>
          <td width="9%">手机/电话</td>
          <td width="8%">所在城市</td>
          <td width="9%">所在区域</td>
          <td width="8%">详细地址</td>
          <td width="8%">注册时间</td>
          <td width="8%">下单次数</td>
          <td width="8%">总消费金额</td>
          <td width="15%">操作</td>
        </tr>
        {%for user in users%}
        <tr class="usertr" id="usertr_{{user.id}}" align="center" bgcolor="#FAFAF1" height="12">
          <td width="12%"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:50px;" id="usrname_{{user.id}}" value="{{user.name}}" /></td>
          <td width="12%">{{user.openid}}</td>
          <td width="5%"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:30px;" id="usrsex_{{user.id}}" value="{{user.sex}}" /></td>
          <td width="9%"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:90px;" id="usrphone_{{user.id}}" value="{{user.telphone}}" /></td>
          <td width="8%"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:30px;" id="usrcity_{{user.id}}" value="深圳" /></td>
          <td width="8%"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:30px;" id="usrarea_{{user.id}}" value="南山" /></td>
          <td width="9%"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:130px;" id="usraddr_{{user.id}}" value="{{user.addr}}" /></td>
          <td width="9%"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:130px;" id="usrdate_{{user.id}}" value="{{user.reg_date|date:'Y-m-d H:i'}}" /></td>
          <td width="8%"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:30px;" id="usraccount_{{user.id}}" value="{{user.account}}" /></td>
          <td width="8%"><input type="text" style="border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;width:30px;" id="usrmny_{{user.id}}" value="{{user.money}}" /></td>
          <td width="15%"><a href="#" onclick="userUpd({{user.id}})">保存</a>|<a href="#" onclick="userDel({{user.id}})">删除</a></td>
        </tr>
        {%endfor%}
    </table>
</div>
<!-- end: userShow -->

<!-- start: configShow -->
<div id="configshow"  style="width: 80%;float:left;margin-left: -2em;">
<div class="well">
          {%for otherset in othersets%}
                <table id="other-config">
                <tr>
                    <td>下单通知手机号码</td>
            <td>
                        <input type="text" maxlength="12" class="span4" id="dx_mobile" name="dx_mobile" placeholder="用户在前端下单后，会把下单的消息发送到该手机，务必填写正确" value="{{otherset.dx_mobile}}">
                        <input type="radio" name="dx_status" value="1">启用
                        <input type="radio" name="dx_status" value="2" checked="">禁用
                    </td>
                </tr>
                <br />

                <tr>
            <td>客服电话</td>
            <td><input type="text" maxlength="13" class="span7" id="kf_phone" name="kf_phone" placeholder="客户电话,如0755-88889999" value="{{otherset.kf_phone}}"></td>
                </tr>
                <br />

                <tr>
            <td>提示内容</td>
            <td><textarea class="span7" rows="6" id="tip_content" name="tip_content" placeholder="下完单后的温馨提示内容">{{otherset.tip_content}}</textarea></td>
                </tr>
                <br />

                <tr>
            <td>配送范围</td>
            <td><textarea class="span7" rows="6" id="distribution_range" name="distribution_range" placeholder="配送范围,比如XXX大厦500以内">{{otherset.distribution_range}}</textarea></td>
                </tr>
                <br />

                <tr>
                    <td><label>设置运费</label></td>
            <td><input type="text" maxlength="6" class="span7" id="freight" name="freight" placeholder="设置配送运费,必须是数字" value="0.00"></td>
                </tr>

                <label></label>
                <tr>
            <td><input type="button" class="btn btn-info" value="保存" onclick="saveOtherSet();"></td>
                </tr>
                <!--tr><td>
                  <label>客服电话：便于用户下单后久未见商品送达的情况下拨打电话给您“催一催”“ </label>
                  <label>提示内容：用户提交订单后，系统给他的提示信息；</label>
                  <label>配送范围：显示微信前端，便于用户识别您的服务区域；</label>
                  <label>下单通知手机号码:用户在前端下单后，会把下单的消息发送到该手机上。</label>
                </td></tr-->
                </table>
        {%endfor%}
    </div>
</div>
<!-- end: configShow -->

<!-- start: ingredientslist -->
<div id="ingredt" style="width: 80%;float:left;margin-left: -2em;">
    <script type="text/javascript">
        var ingid = 0;

	function isPositiveIntegers(val){
	     var re = /^[1-9]+[0-9]*]*$/
	     if (!re.test(val)){
		return false;
	     }
		 return true;
	}

        function chgIngtype(id) {
            // alert("chgingtype: "+id);
            $("#ingredtype").val(id);
            foodid = $("#updfoodid").val();
            // $(this).css("class", "active");
            if ('2' == id) {
                // $(".tr_2").show();
                // $(".tr_1").hide();
                ingid = 0;
                $("#fuliao").addClass("active");
                $("#zhuliao").removeClass("active");
                if ('0' == foodid) {
                    // alert("foodid"+foodid+"remove");
                    $(".tr_1").remove();
                }
                else {
                    $(".tr_1").hide();
                    // alert("foodid"+foodid+"not remove");
                    getIngredts(foodid, 2);
                }
            }
            
            if ('1' == id) {
                // $(".tr_1").show();
                // $(".tr_2").hide();
                ingid = 0;
                $("#zhuliao").addClass("active");
                $("#fuliao").removeClass("active");
                if ('0' == foodid) {
                    // alert("foodid"+foodid+"remove");
                    $(".tr_2").remove();
                } else {
                    $(".tr_2").hide();
                    // alert("foodid"+foodid+"not remove");
                    getIngredts(foodid, 1);
                }
            }
        }

        function saveIngredt() {
            type = $("#ingredtype").val();
            foodid = $("#updfoodid").val();
            foodname = $("#updfoodname").val();
            var names = "",quantitys="",units="";
	    var isNull=true;
	    $("input[name='names']").each( 
		function(){ 
		    var val = $(this).val();
		    val = val.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
		    if(val==''){
			isNull=false;
		    }
		    names+=val+"|"; 
		}  
	    );

            var isInt=true;
	    $("input[name='quantitys']").each( 
		function(){ 
		    var val = $(this).val();
		    val = val.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
		    if(isPositiveIntegers(val)){
		       quantitys+=val+"|"; 
		    }else{
			isInt=false;
		    }
		}  
	    );

	    $("input[name='units']").each( 
		function(){ 
		    units+=$(this).val()+"|"; 
		}  
	    );
	    if(!isNull){
		alert("名称不能为空");
		isNull = true;
		return;
	    }
	    if(!isInt){
		alert("份量只能是正整数");
		isInt = true;
		return;
	    }
	    if(names=='' || quantitys==''){
		alert("名称或份量不能为空");
		return;
	    }else{
		names = names.substring(0,names.length-1);
		quantitys = quantitys.substring(0,quantitys.length-1);
	    }


            $.post("../ingredit/save/", {"goods_id":foodid, "goods_name":foodname, "type":type, "names":names, "quantitys":quantitys, "units":units}, function(data){alert("保存成功");});
        }

        function addIngredt() {
            ingid = ingid + 1;
            typeid = $("#ingredtype").val();
            // alert(typeof(typeid));
            // $("#ingredttr-header").after('<tr class="tr_'+ingid+'"><td><input type="text" ingid="name_'+ingid+'" name="names"></td></td></tr>');
            if ('2' == typeid) {
                $("#ingredttr-header").after('<tr id="ingtr_'+ingid+'" class="tr_2">  <td><input type="text" id="name_'+ingid+'" name="names"></td>  <td class="cl1"><input type="text" style="width:100px;" id="quantity_'+ingid+'" name="quantitys">  <input type="hidden" name="units" id="unit_'+ingid+'" value="2">  <input type="radio" style="margin-bottom:15px;" name="danweis_'+ingid+'" value="1" onclick="saveUnit('+ingid+',1);" checked="">克  <input type="radio" style="margin-bottom:15px;" name="danweis_'+ingid+'" value="2" onclick="saveUnit('+ingid+',2);">包  <input type="radio" style="margin-bottom:15px;" name="danweis_'+ingid+'" value="3" onclick="saveUnit('+ingid+',3);">个  <input type="radio" style="margin-bottom:15px;" name="danweis_'+ingid+'" value="4" onclick="saveUnit('+ingid+',4);">粒  </td><td class="cl1"><a href="javascript:delRow('+ingid+')">删除</a></td></tr>');
            } else {
                $("#ingredttr-header").after('<tr id="ingtr_'+ingid+'" class="tr_1">  <td><input type="text" id="name_'+ingid+'" name="names"></td>  <td class="cl1"><input type="text" style="width:100px;" id="quantity_'+ingid+'" name="quantitys">  <input type="hidden" name="units" id="unit_'+ingid+'" value="2">  <input type="radio" style="margin-bottom:15px;" name="danweis_'+ingid+'" value="1" onclick="saveUnit('+ingid+',1);" checked="">克  <input type="radio" style="margin-bottom:15px;" name="danweis_'+ingid+'" value="2" onclick="saveUnit('+ingid+',2);">包  <input type="radio" style="margin-bottom:15px;" name="danweis_'+ingid+'" value="3" onclick="saveUnit('+ingid+',3);">个  <input type="radio" style="margin-bottom:15px;" name="danweis_'+ingid+'" value="4" onclick="saveUnit('+ingid+',4);">粒  </td><td class="cl1"><a href="javascript:delRow('+ingid+')">删除</a></td></tr>');
            }
        }

        function getIngredts(id, type) {
            ingid = 1;
            // alert("query foodid: "+id);
            ingredtShow();
            $(".tr_1").remove();
            $(".tr_2").remove();
            $.post("../ingredit/query/", {"goods_id":id, "type":type}, function(data){
                if ("ingredt_query"==data) { 
                    alert("未找到符合条件的结果");
                } else {
                    $("#updfoodid").val(id);
                    jsond = eval('('+data+')');
                    for (ii in jsond) {
                        fields = jsond[ii]['fields'];
                        $("#ingredttr-header").after('<tr id="ingtr_'+ingid+'" class="tr_1">  <td><input type="text" id="name_'+ingid+'" name="names" value="'+ fields['name'] + '"></td>  <td class="cl1"><input type="text" style="width:100px;" id="quantity_'+ingid+'" name="quantitys"  value="'+ fields['quantity'] + '">  <input type="hidden" name="units" id="unit_'+ingid+'" value="2">  <input type="radio" style="margin-bottom:15px;" name="danweis_'+ingid+'" value="1" onclick="saveUnit('+ingid+',1);">克  <input type="radio" style="margin-bottom:15px;" name="danweis_'+ingid+'" value="2" onclick="saveUnit('+ingid+',2);">包  <input type="radio" style="margin-bottom:15px;" name="danweis_'+ingid+'" value="3" onclick="saveUnit('+ingid+',3);">个  <input type="radio" style="margin-bottom:15px;" name="danweis_'+ingid+'" value="4" onclick="saveUnit('+ingid+',4);">粒  </td><td class="cl1"><a href="javascript:delRow('+ingid+')">删除</a></td></tr>');
                        // $("input[name='danweis_5']").get(fields['unit']).checked = true;
                        // $("input[name='danweis_5'][value='fields["unit"]']").attr("checked", "checked");
                        // alert("Unit: "+typeof(fields['unit']));
                        ingid = ingid + 1;
                    }
                }
                alert("查询成功");
            });
        }

        function saveUnit(ingid, val) {
            $("#unit_"+ingid).val(val);
            // $.post("../ingredit/save/", {"goods_id":id }, function(data){alert("保存成功");});
        }

        function delRow(line) {
            $("#ingtr_"+line).remove();
        }
    </script>
    <ul class="nav nav-tabs">
        <li id="zhuliao"><a href="#" onclick="chgIngtype(1);return false;">主料</a></li>
        <li id="fuliao"><a href="#" onclick="chgIngtype(2);return false;">辅料</a></li>
    </ul>
    <table width="98%" border="0" cellpadding="2" cellspacing="1" bgcolor="#D1DDAA" align="center" style="margin-top:8px">
        <tr><input id="ingredtype" name='ingredtype' type='hidden' value='0' /></tr>
        <tr>
            <td width="70%"></td>
            <td width=30%>
                <input type="button" style="margin-top:-8px;" class="btn btn-info" value="保存" onclick="saveIngredt();" />
                <input type="button" style="margin-top:-8px;" class="btn btn-info" value="添加行" onclick="addIngredt();" />
            </td>
        </tr>
    </table>
    <table width="98%" border="0" cellpadding="2" cellspacing="1" bgcolor="#D1DDAA" align="center" style="margin-top:8px">
        <tr id='ingredttr-header' align="center" bgcolor="#FAFAF1" height="12">
              <td width="40%">名称</td>
              <td width="40%">分量</td>
              <td width="10%">操作</td>
        </tr>
    </table>
</dvi>
<!-- end: ingredientslist -->

<frameset rows="60,*" cols="*" frameborder="no" border="0" framespacing="0">
  <frame src="top.html" name="topFrame" scrolling="no">
  <frameset cols="180,*" name="btFrame" frameborder="NO" border="0" framespacing="0">
    <frame src="../../menu.html" noresize name="menu" scrolling="yes">
    <frame src="../../archives.html" noresize name="main" scrolling="yes">
  </frameset>
</frameset>
<noframes>
    <body>Your browser does not support frame</body>
</noframes>
</html>
